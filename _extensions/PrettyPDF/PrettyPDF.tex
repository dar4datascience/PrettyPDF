% Load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{graphicx}  % Ensure graphics package is loaded for watermark
\usepackage{everypage}
\usepackage{tikz}


% Set page size with a wider right margin
\geometry{a4paper, total={170mm,257mm}, left=20mm, top=20mm, bottom=20mm, right=50mm}

% Define some colors
\definecolor{light}{HTML}{E6E6FA}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{330033}

% Add the border on the right-hand side
\AddToShipoutPicture{% 
    \AtPageLowerLeft{% 
        \put(\LenToUnit{\dimexpr\paperwidth-3cm},0){% 
            \color{light}\rule{3cm}{\LenToUnit\paperheight}%
          }%
     }%
     % Logo
    \AtPageLowerLeft{% 
        \put(\LenToUnit{\dimexpr\paperwidth-2.25cm},27.2cm){% 
            \color{light}\includegraphics[width=1.5cm]{_extensions/PrettyPDF/logo.png}%
          }%
     }%
}

% Add watermark in every page
\AddEverypageHook{%
    \begin{tikzpicture}[remember picture,overlay]
        \node at (current page.center) {\rotatebox{45}{\textcolor{gray!50}{\Huge DRAFT}}};
    \end{tikzpicture}
}



% Style the page number
\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyfoot[R]{\thepage}
  \fancyfootoffset{3.5cm}
}
\setlength{\footskip}{20pt}

% Style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\sectionfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\subsectionfont{\color{dark}\fontsize{14}{16.8}\selectfont}
\titleformat{\subsection}
  {\sffamily\Large\bfseries}{\thesection}{1em}{}[{\titlerule[0.8pt]}]

% Left align title
\makeatletter
\renewcommand{\maketitle}{\bgroup\setlength{\parindent}{0pt}
\begin{titlepage}
    \begin{center}
        \vspace*{3cm}
        {\sffamily\Huge\textbf{\MakeUppercase{\@title}}}\\[1cm]
        \ifx\@subtitle\empty\else {\Large \@subtitle}\\[2cm] \fi
        \@author\\[2cm]
        {\large \today}
    \end{center}
\end{titlepage}
\egroup}
\makeatother

% Use some custom fonts
\setsansfont{Ubuntu}[
    Path=_extensions/PrettyPDF/Ubuntu/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]

\setmainfont{Ubuntu}[
    Path=_extensions/PrettyPDF/Ubuntu/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]
